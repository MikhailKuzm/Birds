# Предсказание вида птиц по их пению

Приложение определяет 88 видов птиц по аудиозаписи их пения, используя mel-спектограмное представление звука, аугментацию данных и архитектуру нейронной сети ResNet18.

## Структура
### Предобработка данных
Набор используемых данных состоит всего из 264 звуковых файлов. Поскольку всего 88 классов, то на каждый класс приходится около 3 звуковых записей.
Чтобы искуственно увеличить объём обучающей выборки была проведена аугментация данных. Перед построением мел-спектограммы и её передачи в модель
каждый тензор сэмплов на каждой итерации обучения изменялся случайным образом. Эти преобразования включают:
1. изменение высоты звука;
2. сдиг значений по оси времени;
3. добавление шума.

Полученные тензоры сэмплов затем преобразовывались в мел-спектограммы. При обучении модели на каждой итереции каждая мел-спектограмма тоже случайным образом изменялась.
Изменение заключалось в применении случайных "маски частоты звука" и "маски времени", которые вырезали часть мел-спектограмм по оси частоты звука и оси времени соответственно.
На рисунках ниже показано применение таких масок к мел-спектограмме до и после аугментации данных. Хотя оба рисунка выражают один и тот же звковой файл, выглядят они не одинаково
благодаря проведённой аугментации.
 
 <p align="center">
  <img src="https://raw.githubusercontent.com/MikhailKuzm/Birds/master/native_spec.png" width="500" />

  <img src="https://raw.githubusercontent.com/MikhailKuzm/Birds/master/aug_spec.png" width="500" />
</p>
 
 ### Обучение модели
 В качестве модели была выбрана нейронная сеть архитектуры ResNet18. Поскольку необходимо определять 88 видов птиц, количество выходных нейронов 
 последнего линейного слоя модели было изменено с 1000 на 88. Модель обучалась 40 эпох. Веса нейронной сети сохранены в файле best_weight.pth.
 <p align="center">
 <b>Архитектура ResNet18</b>
 </p>
 <p align="center">
  <img src="https://www.mdpi.com/futureinternet/futureinternet-10-00080/article_deploy/html/images/futureinternet-10-00080-g002.png" />
 </p>
 
 ### Предсказание
 Для предсказания была определна функция predict, которая ожидает одну мел-спектограмму. С помощью словаря, предсказанные классы в виде <b>int</b> переводятся в английские наименования
 предсказанного вида птиц.
 
 
## Файлы
 
 
